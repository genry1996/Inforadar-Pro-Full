{% extends "base.html" %}

{% block content %}
<div class="matches-container">
  <h2 class="page-title fade-in">üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–∞—Ç—á–µ–π</h2>
  <p class="fade-in-delay">
    –°–ª–µ–¥–∏—Ç–µ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
    –¢–∞–±–ª–∏—Ü–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ <b>10 —Å–µ–∫—É–Ω–¥</b> —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º shimmer-–∞–Ω–∏–º–∞—Ü–∏–∏ ‚ö°
  </p>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã -->
  <div id="matches-table" class="fade-in-late"></div>
</div>
{% endblock %}

{% block scripts %}
<style>
/* ====== shimmer —ç—Ñ—Ñ–µ–∫—Ç ====== */
.shimmer {
  position: relative;
  overflow: hidden;
  background: #f6f7f8;
  background-image: linear-gradient(
    to right,
    #f6f7f8 0%,
    #edeef1 20%,
    #f6f7f8 40%,
    #f6f7f8 100%
  );
  background-repeat: no-repeat;
  background-size: 800px 100%;
  animation: shimmer 1.5s linear infinite;
  border-radius: 8px;
}
@keyframes shimmer {
  0% { background-position: -800px 0; }
  100% { background-position: 800px 0; }
}
.shimmer-container { padding: 15px; }
.shimmer-line { height: 18px; margin-bottom: 10px; border-radius: 6px; }

/* ====== —Ç–∞–±–ª–∏—Ü–∞ ====== */
#matches-table table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
  background: #fff9ef;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 0 8px rgba(0,0,0,0.05);
  transition: opacity 0.4s ease;
}
#matches-table th, #matches-table td {
  padding: 10px 12px;
  text-align: center;
  border-bottom: 1px solid #f1e6c4;
}
#matches-table th {
  background: #ffecb3;
  font-weight: 600;
  color: #795548;
}
#matches-table tr:hover {
  background: #fff3d1;
}

/* fade-in —ç—Ñ—Ñ–µ–∫—Ç */
.fade-in-table {
  animation: fadeIn 0.6s ease-in;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // --- shimmer-–∞–Ω–∏–º–∞—Ü–∏—è ---
  function showShimmer() {
    const table = document.getElementById("matches-table");
    table.innerHTML = `
      <div class="shimmer-container">
        <div class="shimmer shimmer-line" style="width: 90%; height: 20px;"></div>
        <div class="shimmer shimmer-line" style="width: 70%; height: 20px;"></div>
        <div class="shimmer shimmer-line" style="width: 80%; height: 20px;"></div>
        <div class="shimmer shimmer-line" style="width: 60%; height: 20px;"></div>
      </div>
    `;
  }

  // --- –∑–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ç—á–µ–π ---
  async function loadMatches() {
    showShimmer();
    try {
      const response = await fetch("/api/matches");
      const data = await response.json();
      setTimeout(() => renderTable(data), 500); // –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
    } catch (err) {
      console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:", err);
    }
  }

  // --- –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã ---
  function renderTable(matches) {
    const table = document.getElementById("matches-table");

    if (!matches || matches.length === 0) {
      table.innerHTML = "<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p>";
      return;
    }

    let html = `
      <table class="fade-in-table">
        <thead>
          <tr>
            <th>–°–ø–æ—Ä—Ç</th>
            <th>–õ–∏–≥–∞</th>
            <th>–î–æ–º</th>
            <th>–ì–æ—Å—Ç–∏</th>
            <th>–°—á—ë—Ç</th>
            <th>–í—Ä–µ–º—è</th>
          </tr>
        </thead>
        <tbody>
    `;

    matches.forEach(m => {
      html += `
        <tr>
          <td>${m.sport}</td>
          <td>${m.league}</td>
          <td>${m.home_team}</td>
          <td>${m.away_team}</td>
          <td>${m.score_home ?? "-"} : ${m.score_away ?? "-"}</td>
          <td>${m.start_time}</td>
        </tr>
      `;
    });

    html += "</tbody></table>";
    table.innerHTML = html;
  }

  // --- –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ ---
  loadMatches();
  setInterval(loadMatches, 10000);
});
</script>
{% endblock %}
