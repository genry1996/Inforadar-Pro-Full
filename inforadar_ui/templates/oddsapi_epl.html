<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>The Odds API — EPL</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 20px;
      background: #0b1020;
      color: #f5f5f5;
    }
    h2 {
      margin-top: 0;
      margin-bottom: 10px;
    }
    .card {
      background: #181d2f;
      border-radius: 10px;
      padding: 16px;
      margin-top: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }
    th, td {
      padding: 8px 10px;
      vertical-align: top;
    }
    th {
      text-align: left;
      border-bottom: 1px solid #303448;
    }
    tr:nth-child(even) td {
      background: #111526;
    }
    .bookmaker-block {
      margin-bottom: 4px;
    }
    .bookmaker-name {
      font-weight: 600;
      color: #ffd14d;
    }
    .outcome-line {
      font-size: 13px;
    }
    .muted {
      color: #999;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <h2>The Odds API — EPL (soccer_epl)</h2>
  <p class="muted">
    Источник: The Odds API (markets: H2H, region: EU). Данные загружаются из таблиц oddsapi_events / oddsapi_odds.
  </p>

  {% if not events %}
    <div class="card">
      <p>Нет событий EPL в таблице <code>oddsapi_events</code>. Сначала запусти sync_odds_to_mysql.py.</p>
    </div>
  {% else %}
    <div class="card">
      <table>
        <thead>
          <tr>
            <th>Время (UTC)</th>
            <th>Матч</th>
            <th>H2H коэффициенты по букмекерам</th>
          </tr>
        </thead>
        <tbody>
        {% for ev in events %}
          <tr>
            <td>{{ ev.commence_time }}</td>
            <td>{{ ev.home_team }} vs {{ ev.away_team }}</td>
            <td>
              {% if not ev.odds %}
                <span class="muted">нет H2H по этому матчу</span>
              {% else %}
                {% for row in ev.odds %}
                  <div class="bookmaker-block">
                    <span class="bookmaker-name">{{ row.bookmaker_title }}</span>
                    <span class="outcome-line">
                      — {{ row.outcome_name }}: {{ row.outcome_price }}
                    </span>
                    {% if row.last_update %}
                      <span class="muted">
                        ({{ row.last_update }})
                      </span>
                    {% endif %}
                  </div>
                {% endfor %}
              {% endif %}
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}
</body>
</html>
